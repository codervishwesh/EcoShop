{% extends 'base.html' %}
{% block title %}Reports - EcoShop{% endblock %}
{% block content %}
<div class="bg-gradient-to-r from-indigo-600 to-purple-700 py-8">
    <div class="container mx-auto px-4">
        <h1 class="text-3xl font-bold text-white">üìä Reports & Analytics</h1>
    </div>
</div>
<div class="container mx-auto px-4 py-8">
    <div class="mb-6">
        <form method="GET" class="flex gap-4 items-center">
            <span class="text-gray-700">Time Period:</span>
            <select name="days" class="px-4 py-2 border rounded-lg" onchange="this.form.submit()">
                <option value="7" {% if days == 7 %}selected{% endif %}>Last 7 days</option>
                <option value="30" {% if days == 30 %}selected{% endif %}>Last 30 days</option>
                <option value="90" {% if days == 90 %}selected{% endif %}>Last 90 days</option>
                <option value="365" {% if days == 365 %}selected{% endif %}>Last year</option>
            </select>
        </form>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <div class="bg-white rounded-xl shadow-md p-6">
            <p class="text-gray-500 text-sm">Total Orders</p>
            <p class="text-3xl font-bold text-gray-800">{{ stats.total_orders }}</p>
        </div>
        <div class="bg-white rounded-xl shadow-md p-6">
            <p class="text-gray-500 text-sm">Total Revenue</p>
            <p class="text-3xl font-bold text-green-600">${{ stats.total_revenue|floatformat:2 }}</p>
        </div>
        <div class="bg-white rounded-xl shadow-md p-6">
            <p class="text-gray-500 text-sm">Avg Order Value</p>
            <p class="text-3xl font-bold text-blue-600">${{ stats.avg_order_value|floatformat:2 }}</p>
        </div>
        <div class="bg-white rounded-xl shadow-md p-6">
            <p class="text-gray-500 text-sm">New Customers</p>
            <p class="text-3xl font-bold text-purple-600">{{ new_users }}</p>
        </div>
    </div>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div class="bg-white rounded-xl shadow-md p-6">
            <h3 class="font-bold text-xl mb-4">üå± Eco Impact</h3>
            <div class="space-y-4">
                <div class="flex justify-between"><span>Eco Points Awarded:</span><span class="font-bold text-green-600">{{ stats.total_eco_points }}</span></div>
                <div class="flex justify-between"><span>CO‚ÇÇ Saved:</span><span class="font-bold text-green-600">{{ stats.total_co2_saved|floatformat:2 }} kg</span></div>
            </div>
        </div>
        <div class="bg-white rounded-xl shadow-md p-6">
            <h3 class="font-bold text-xl mb-4">üì¶ Top Products</h3>
            <div class="space-y-2">
                {% for product in top_products %}
                <div class="flex justify-between p-2 bg-gray-50 rounded">
                    <span>{{ product.product_name|truncatechars:30 }}</span>
                    <span class="font-bold">{{ product.total_sold }} sold</span>
                </div>
                {% empty %}
                <p class="text-gray-500">No data available</p>
                {% endfor %}
            </div>
        </div>
    </div>
    <a href="{% url 'accounts:management_dashboard' %}" class="inline-block mt-6 text-indigo-600 hover:underline">‚Üê Back to Dashboard</a>
</div>
{% endblock %}
